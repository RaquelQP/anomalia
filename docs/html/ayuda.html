<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Ayuda ‚Äî Anomalia</title>
  <link rel="stylesheet" href="styles/popup.css">
  <style>
    body { font-family: Arial, sans-serif; margin: 2em; background: #fff; color: #222; }
    h1, h2 { color: #1a73e8; }
    .ejemplo { background: #f3f3f3; border-left: 4px solid #1a73e8; padding: 0.5em 1em; margin: 1em 0; }
    a { color: #1a73e8; }
    nav { margin-bottom: 2em; }
    nav a { margin-right: 1em; }
    .ayuda-icono { width: 18px; height: 18px; vertical-align: middle; cursor: pointer; }
  </style>
</head>
<body>
  <h1>¬øC√≥mo funciona Anomalia?</h1>
  <p>
    Anomalia le ayuda a identificar enlaces sospechosos en su correo electr√≥nico. <b>No impide la conexi√≥n a ning√∫n enlace</b>; √∫nicamente muestra una advertencia final para que tome una decisi√≥n informada antes de hacer clic.
  </p>
  <div style="background:#f8f8f8;border-left:5px solid #e74c3c;padding:1em;margin-bottom:2em;">
    <strong>üî¥ Alerta roja:</strong> Los enlaces marcados en <span style="color:#e74c3c;font-weight:bold;">rojo</span> son considerados de <b>riesgo</b> y la protecci√≥n est√° <b>siempre activa</b>. Estos enlaces presentan caracter√≠sticas que suelen asociarse a intentos de enga√±o, fraude o suplantaci√≥n de identidad.
  </div>
  <nav>
    <a href="#acortadores">Acortadores</a>
    <a href="#ip">Enlaces a IPs</a>
    <a href="#unicode">Unicode</a>
    <a href="#credenciales">Credenciales</a>
    <a href="#redirect">Redirecciones</a>
    <a href="#homoglifos">Homoglifos</a>
    <a href="#punycode">Punycode</a>
    <a href="#subdominios">Subdominios</a>
    <a href="#url-larga">URL larga</a>
    <a href="#tld-peligroso">TLD peligroso</a>
    <a href="#http">HTTP</a>
    <a href="#puerto">Puerto</a>
    <a href="#camuflaje">Camuflaje</a>
    <a href="#dominio-nuevo">Dominio nuevo</a>
    <a href="#dominio-caducado">Dominio caducado</a>
    <a href="#sin-datos">Falta de datos</a>
  </nav>

  <h2 id="acortadores">üî¥ Acortadores de URL</h2>
  <p>Los acortadores ocultan el destino real del enlace. Anomalia detecta <b>m√°s de 45 servicios</b> categorizados por riesgo:</p>
  
  <h3>Acortadores p√∫blicos (muy peligrosos)</h3>
  <p>Servicios donde <b>cualquiera puede crear enlaces</b> sin restricciones:</p>
  <div class="ejemplo">
    bit.ly, t.co, goo.gl, tinyurl.com, ow.ly, is.gd, buff.ly, shorturl.at, rebrand.ly, lnkd.in, s.id, cut.ly, tiny.cc, bit.do, cutt.ly, t2m.io, short.io, bl.ink, cli.re, lnnk.in
  </div>
  
  <h3>Acortadores maliciosos conocidos</h3>
  <p>Servicios con <b>historial de distribuci√≥n de malware</b>:</p>
  <div class="ejemplo">
    adf.ly, sh.st, adfly.com, shorte.st, bc.vc, bcvc.live, bcvc.com, coinurl.com, cur.lv, dlvr.it, go2cloud.org, ht.ly, ift.tt, j.mp, kutt.it, migre.me, moourl.com, myurl.in, post.ly, rww.to, scrnch.me, snip.ly, snipurl.com, soo.gd, su.pr, tny.im, tr.im, trib.al, tweez.me, twitthis.com, u.mavrev.com, u.nu, ubr.to, ur1.ca, url.ie, url4.eu, v.gd, vzturl.com, w.wiki, waa.ai, x.co, xrl.us, zite.to, zpr.io
  </div>
  
  <h3>Acortadores semi-controlados</h3>
  <p>Servicios con <b>restricciones parciales</b> pero a√∫n de riesgo:</p>
  <div class="ejemplo">
    fb.me, lnkd.in
  </div>
  
  <p><b>Recomendaci√≥n:</b> Si no conf√≠a en el remitente, no haga clic. Puede comprobar el destino en <a href="https://www.expandurl.net/" target="_blank">ExpandURL</a> o <a href="https://www.virustotal.com/" target="_blank">VirusTotal</a>.</p>

  <h2 id="ip">üî¥ Enlaces a direcciones IP</h2>
  <p>Un enlace que apunta directamente a una IP puede ser sospechoso.</p>
  <div class="ejemplo">
    Ejemplo: <code>http://192.168.1.1/login</code>
  </div>
  <p>Compruebe la IP en <a href="https://whois.domaintools.com/" target="_blank">Whois</a> o <a href="https://www.virustotal.com/" target="_blank">VirusTotal</a>.</p>

  <h2 id="unicode">üî¥ Caracteres Unicode sospechosos</h2>
  <p>Anomalia detecta enlaces que usan letras de otros alfabetos para parecer leg√≠timos. Incluye <b>m√∫ltiples rangos Unicode</b>:</p>
  
  <h3>Alfabetos extranjeros</h3>
  <p>Letras de alfabetos cir√≠licos, griegos, armenios y otros que pueden confundirse:</p>
  <div class="ejemplo">
    Alfabetos cir√≠licos, griegos, armenios, hebreos, √°rabes, tailandeses, georgianos, et√≠opes, coptos, tibetanos, mongoles, etc.
  </div>
  
  <h3>S√≠mbolos de letras</h3>
  <p>Caracteres que parecen letras pero son s√≠mbolos matem√°ticos o tipogr√°ficos:</p>
  <div class="ejemplo">
    S√≠mbolos como ‚Öº (script small l), ‚Ñì (mathematical script small l), ‚Ñé (planck constant), etc.
  </div>
  
  <p><b>Ejemplo:</b> <code>paypa‚Öº.com</code> (la "l" es un s√≠mbolo matem√°tico, no una "l" latina)</p>
  <p><b>Recomendaci√≥n:</b> Si ve un enlace raro, desconf√≠e y revise la direcci√≥n cuidadosamente.</p>

  <h2 id="credenciales">üî¥ Credenciales en URLs</h2>
  <p>Si una URL contiene usuario y contrase√±a, puede ser un intento de enga√±o.</p>
  <div class="ejemplo">
    Ejemplo: <code>http://usuario:contrase√±a@ejemplo.com</code>
  </div>
  <p>No introduzca sus datos en sitios sospechosos.</p>

  <h2 id="redirect">üî¥ Redirecciones sospechosas</h2>
  <p>Algunos enlaces usan par√°metros de redirecci√≥n para enviarte a otro sitio. Anomalia detecta m√∫ltiples par√°metros sospechosos:</p>
  <div class="ejemplo">
    Par√°metros b√°sicos: <code>redirect</code>, <code>url</code>, <code>next</code>, <code>continue</code>, <code>target</code><br>
    Par√°metros avanzados: <code>goto</code>, <code>link</code>, <code>href</code>, <code>destination</code>, <code>to</code>, <code>return</code>, <code>back</code>, <code>forward</code>, <code>jump</code>
  </div>
  <div class="ejemplo">
    Ejemplo: <code>https://ejemplo.com?redirect=http://malicioso.com</code><br>
    Ejemplo: <code>https://ejemplo.com?goto=http://phishing-site.com</code>
  </div>
  <p>Puede analizar el enlace en <a href="https://www.virustotal.com/" target="_blank">VirusTotal</a>.</p>

  <h2 id="homoglifos">üî¥ Homoglifos y caracteres invisibles</h2>
  <p>Anomalia detecta <b>m√°s de 60 caracteres</b> que pueden usarse para camuflar enlaces maliciosos:</p>
  
  <h3>Espacios invisibles</h3>
  <p>11 tipos diferentes de espacios Unicode que pueden ocultar contenido:</p>
  <div class="ejemplo">
    Espacios de diferentes anchos, espacios sin salto, espacios ideogr√°ficos, espacios matem√°ticos
  </div>
  
  <h3>Marcas direccionales</h3>
  <p>Caracteres que cambian el orden de lectura del texto:</p>
  <div class="ejemplo">
    Marcas de izquierda a derecha, derecha a izquierda, aislados direccionales
  </div>
  
  <h3>Conectores invisibles</h3>
  <p>Caracteres de ancho cero que pueden unir o separar texto invisiblemente:</p>
  <div class="ejemplo">
    ZERO WIDTH JOINER, ZERO WIDTH NON-JOINER, conectores de palabra
  </div>
  
  <h3>Caracteres de control</h3>
  <p>Separadores de l√≠nea, caracteres braille en blanco y marcas de formato:</p>
  <div class="ejemplo">
    Separadores de l√≠nea, caracteres de formato bidireccional, caracteres de control adicionales
  </div>
  
  <h3>Caracteres de puntuaci√≥n confusos</h3>
  <p>Comillas y l√≠neas que pueden confundir en URLs:</p>
  <div class="ejemplo">
    Comillas tipogr√°ficas, guiones largos, l√≠neas de diferentes tipos
  </div>
  
  <p><b>Ejemplo:</b> <code>micros‚Äìft.com</code> (el guion es un guion largo Unicode, no el guion normal)</p>
  <p><b>Recomendaci√≥n:</b> Si tiene dudas, copie el enlace y p√©guelo en un editor de texto para revisarlo.</p>

  <h2 id="punycode">üî¥ Codificaci√≥n Punycode</h2>
  <p>Punycode es una t√©cnica que permite usar caracteres Unicode en nombres de dominio. Los atacantes la usan para crear dominios que se ven leg√≠timos pero redirigen a sitios maliciosos.</p>
  <div class="ejemplo">
    Ejemplo: <code>xn--paypal-123.com</code> (dominio punycode que puede parecer "paypal.com")
  </div>
  <p>Los dominios punycode comienzan con <code>xn--</code> y son especialmente peligrosos porque pueden camuflar caracteres de alfabetos extranjeros que se ven como letras latinas normales.</p>
  <p><b>Recomendaci√≥n:</b> Si ve un dominio que comienza con "xn--", tenga especial precauci√≥n.</p>

  <h2 id="subdominios">üî¥ Subdominios excesivos</h2>
  <p>Algunos atacantes crean dominios con muchos subdominios para evadir filtros de seguridad o confundir a los usuarios.</p>
  <div class="ejemplo">
    Ejemplo: <code>secure.login.verify.account.update.bank.com</code> (5 subdominios, muy sospechoso)
  </div>
  <p>Los dominios leg√≠timos raramente tienen m√°s de 3 subdominios. Ejemplos normales:</p>
  <div class="ejemplo">
    <code>mail.google.com</code> (1 subdominio)<br>
    <code>docs.google.com</code> (1 subdominio)<br>
    <code>support.microsoft.com</code> (1 subdominio)
  </div>
  <p><b>Recomendaci√≥n:</b> Si ve un dominio con m√°s de 3 subdominios, examine cuidadosamente la URL antes de hacer clic.</p>

  <h2 id="url-larga">üî¥ URL excesivamente larga</h2>
  <p>Algunos atacantes usan URLs muy largas para evadir filtros de seguridad o confundir a los usuarios.</p>
  <div class="ejemplo">
    Ejemplo: <code>https://legitimate-site.com/very/long/path/with/many/parameters/and/redirects/that/eventually/lead/to/malicious/site</code> (m√°s de 200 caracteres)
  </div>
  <p>Las URLs leg√≠timas suelen ser m√°s cortas y claras. Ejemplos normales:</p>
  <div class="ejemplo">
    <code>https://google.com/search?q=test</code> (35 caracteres)<br>
    <code>https://github.com/user/repo</code> (25 caracteres)<br>
    <code>https://stackoverflow.com/questions/123</code> (40 caracteres)
  </div>
  <p><b>Recomendaci√≥n:</b> Si ve una URL excesivamente larga (m√°s de 200 caracteres), examine cuidadosamente la direcci√≥n antes de hacer clic.</p>

  <h2 id="tld-peligroso">üî¥ TLD de alto riesgo</h2>
  <p>Algunos TLDs (extensiones de dominio) son considerados de alto riesgo por ser gratuitos, muy baratos o tener verificaci√≥n m√≠nima.</p>
  <div class="ejemplo">
    TLDs gratuitos: <code>.tk</code>, <code>.ml</code>, <code>.ga</code>, <code>.cf</code>, <code>.gq</code><br>
    TLDs muy baratos: <code>.xyz</code>, <code>.top</code>, <code>.click</code>
  </div>
  <p>Estos TLDs son frecuentemente usados en ataques de phishing y spam porque:</p>
  <ul>
    <li>Son gratuitos o muy baratos (menos de $1/a√±o)</li>
    <li>Tienen verificaci√≥n m√≠nima de identidad</li>
    <li>Son populares entre atacantes</li>
  </ul>
  <p><b>Recomendaci√≥n:</b> Si ve un dominio que termina en uno de estos TLDs, tenga especial precauci√≥n.</p>

  <h2 id="http">üî¥ Conexi√≥n no segura (HTTP)</h2>
  <p>Los enlaces que usan HTTP en lugar de HTTPS no son seguros. Los datos se transmiten en texto plano y pueden ser interceptados.</p>
  <div class="ejemplo">
    Ejemplo inseguro: <code>http://ejemplo.com/login</code><br>
    Ejemplo seguro: <code>https://ejemplo.com/login</code>
  </div>
  <p>Los sitios leg√≠timos modernos usan HTTPS por defecto. Los enlaces HTTP pueden ser:</p>
  <ul>
    <li>Sitios que no han migrado a HTTPS (cada vez menos comunes)</li>
    <li>Intentos de phishing que evitan HTTPS para evitar detecci√≥n</li>
    <li>Sitios maliciosos que no invierten en certificados SSL</li>
  </ul>
  <p><b>Recomendaci√≥n:</b> Si ve un enlace HTTP, tenga precauci√≥n. Los sitios leg√≠timos modernos usan HTTPS.</p>

  <h2 id="puerto">üî¥ Puerto no est√°ndar</h2>
  <p>Algunos enlaces usan puertos no est√°ndar para evadir filtros de seguridad o confundir a los usuarios.</p>
  <div class="ejemplo">
    Ejemplo: <code>https://ejemplo.com:8080/login</code> (puerto 8080 en lugar del est√°ndar 443)<br>
    Ejemplo: <code>https://ejemplo.com:8443/admin</code> (puerto 8443 en lugar del est√°ndar 443)
  </div>
  <p>Los puertos est√°ndar son 80 (HTTP) y 443 (HTTPS). Los puertos no est√°ndar pueden indicar:</p>
  <ul>
    <li>Servidores de desarrollo o internos (leg√≠timos pero no para usuarios finales)</li>
    <li>Intentos de evadir filtros de seguridad</li>
    <li>Servicios proxy o de redirecci√≥n maliciosos</li>
  </ul>
  <p><b>Recomendaci√≥n:</b> Si ve un enlace con un puerto no est√°ndar, tenga precauci√≥n. Los servicios leg√≠timos suelen usar puertos est√°ndar.</p>

  <h2 id="camuflaje">üî¥ Camuflaje tipogr√°fico</h2>
  <p>Algunos enlaces usan caracteres similares para enga√±ar (por ejemplo, "0" y "O", "1" y "l"). La extensi√≥n detecta autom√°ticamente estos caracteres ambiguos y los considera de riesgo cuando el dominio es nuevo (menos de un a√±o) o presenta otros motivos de alerta.</p>
  <div class="ejemplo">
    Ejemplo: <code>micros0ft.com</code> (con un cero en vez de "o")</div>
  <p>El camuflaje tipogr√°fico se considera especialmente peligroso cuando se combina con dominios recientes, dominios caducados o par√°metros sospechosos. F√≠jese bien en los caracteres antes de hacer clic.</p>

  <h2 id="dominio-nuevo">üî¥ Dominio nuevo</h2>
  <p>Los dominios registrados hace menos de un a√±o son considerados de riesgo, ya que los atacantes suelen crear dominios nuevos para evitar detecciones.</p>
  <div class="ejemplo">
    Ejemplo: <code>https://nuevo-sitio-sospechoso.com</code> (dominio registrado recientemente)
  </div>
  <p>La extensi√≥n muestra la fecha de registro del dominio para que pueda evaluar su antig√ºedad. Los dominios nuevos requieren mayor precauci√≥n.</p>

  <h2 id="dominio-caducado">üî¥ Dominio caducado</h2>
  <p>Los dominios que han caducado o no se han renovado pueden ser peligrosos, ya que pueden haber sido comprados por atacantes para usarlos maliciosamente.</p>
  <div class="ejemplo">
    Ejemplo: <code>https://dominio-caducado.com</code> (dominio que no se ha renovado)
  </div>
  <p>La extensi√≥n distingue entre dominios realmente caducados (fecha de expiraci√≥n pasada) y dominios que no se han renovado en m√°s de un a√±o (estimaci√≥n). En ambos casos, se recomienda precauci√≥n.</p>

  <h2 id="sin-datos">Advertencia por falta de datos registrales</h2>
  <p>Si ve el mensaje:</p>
  <div class="ejemplo">
    Precauci√≥n. No se han podido obtener los datos registrales ni evaluar el riesgo asociado. Compruebe que el nombre de dominio sea correcto antes de pulsar.
  </div>
  <p>Significa que no se ha podido comprobar la fiabilidad del dominio. Esto puede ocurrir por:</p>
  <ul>
    <li>El dominio no existe o est√° mal escrito</li>
    <li>El TLD (extensi√≥n del dominio) no est√° soportado por los servidores RDAP</li>
    <li>Problemas temporales de conectividad con los servidores de registro</li>
  </ul>
  <p>Revise el nombre del dominio con especial atenci√≥n. Puede obtener datos registrales manualmente en <a href="https://whois.domaintools.com/" target="_blank">Whois</a> o <a href="https://www.virustotal.com/" target="_blank">VirusTotal</a>.</p>
  <p style="font-size:0.95em;color:#555;">
    <b>¬øEs usuario avanzado?</b> Puede consultar los datos registrales y detalles t√©cnicos de cada dominio directamente en la consola de su navegador (F12 &rarr; pesta√±a <b>Consola</b>). Los logs aparecen con el prefijo <code>[Anomalia][USUARIO]</code> para facilitar su identificaci√≥n.
  </p>

  <hr>
  <p>¬øTiene dudas? Consulte la <a href="https://github.com/RaquelQP/anomalia/wiki" target="_blank">Wiki</a> o abra una <a href="https://github.com/RaquelQP/anomalia/issues" target="_blank">issue</a>.</p>
  <p style="font-size: 0.95em; color: #555; margin-top: 2em;">
    <b>Recuerde:</b> Pueden realizarse intentos de phishing a trav√©s de otros medios y no se han recogido todos los tipos de caracteres confusos que existen. Por tanto, <b>act√∫e siempre con precauci√≥n</b> antes de pulsar un enlace desde su correo electr√≥nico y mantenga una actitud responsable.
  </p>
  <div style="margin-top:2em; font-size:0.98em; background:#f8f8f8; border-left:4px solid #1a73e8; padding:1em;">
    <b>¬øQuiere experimentar?</b> En la <a href="https://github.com/RaquelQP/anomalia/wiki/Enlaces-de-prueba-para-Anomalia" target="_blank">Wiki del proyecto</a> tiene una <b>lista de enlaces de prueba</b> y acceso a la <b>herramienta generadora de enlaces</b> para que pueda comprobar c√≥mo funciona la extensi√≥n en diferentes escenarios.
  </div>
</body>
</html> 